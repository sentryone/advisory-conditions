{"ID":"b63f8879-c033-472e-9373-dd6c39bba04f","VersionNumber":4,"Name":"High Rows in In-memory Staging Table","Description":"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<head>\r\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>\r\n\t\t</title>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t.cs2654AE3A{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}\r\n\t\t\t.csBEC5BAA2{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;}\r\n\t\t\t.csE19E36D{color:#000000;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:italic;}\r\n\t\t</style>\r\n\t</head>\r\n\t<body>\r\n\t\t<p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">Returns all in-memory performance data staging tables with an unusually high number of rows. Default=500,000, but this may need to be adjusted per environment.</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">&nbsp;</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">When the number of rows is over the threshold, it means that the MovePABufferData procedure is not keeping up with the volume of incoming performance data, and thus is not moving data from the in-memory tables into the CCI tables quickly enough. This can be caused by:</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">1) High latency network links between the S1 Monitoring Service(s) and the S1 database which is causing the performance data for some targets to be written too slowly. The Move process will wait up to 60 seconds by default for committing each new timestamp, and continual lag may lead to an accumulation of staging data. Contact S1 Support for assistance troubleshooting slow links.</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">2) The Move process is not running -- the associated thread may have experienced and error and not restarted successfully. Restart the primary S1 Monitoring Service to reset it -- this is the one with with the oldest &quot;Last Initialized&quot; time under All Targets-&gt;Show Monitoring Services List.</span></p><p class=\"cs2654AE3A\"><span class=\"csBEC5BAA2\">3) Transient maintenance activities like index rebuilds, backups, etc., which can cause resource contention and/or blocking leading to temporary queueing of the staging data. The max value can be adjusted to account for these spikes, or a Response Ruleset can be used to wait for </span><span class=\"csE19E36D\">n </span><span class=\"csBEC5BAA2\">minutes before alerting.</span></p></body>\r\n</html>\r\n","AppliesToObjectTypeID":"894de672-3fc0-4779-9a0d-880d4c207c77","ConditionCategoryID":"805a84c9-7f1b-4b4d-a9ad-3dddcf9e0f17","OwnerObjectID":"b7c74f24-1a45-4115-8262-d7613878bbd6","OwnerObjectTypeID":"894de672-3fc0-4779-9a0d-880d4c207c77","RuleDefinition":"{\"OperationTypeID\":\"6c3d38f1-9317-4258-972a-cfee0a0d76b5\",\"Children\":[{\"OperationTypeID\":\"8fa3cd6a-960c-43bb-96e0-94092fc2c296\",\"ValueDataTypeID\":\"b35a57f5-b8f6-4e4e-9380-e9d328e3eabf\",\"Left\":{\"ValueTypeID\":\"f2e88d72-73c6-4ce1-b92a-029c313e707f\",\"Query\":\"set nocount on\\r\\n\\r\\ndeclare @t nvarchar(128)\\r\\ndeclare @sql nvarchar(1000)\\r\\ndeclare @table table\\r\\n\\t([name] nvarchar(128)\\r\\n\\t,[count] bigint)\\r\\n\\r\\ndeclare cur cursor fast_forward\\r\\nfor\\r\\n\\tselect name from sys.objects\\r\\n\\twhere schema_id = SCHEMA_ID('Staging')\\r\\n\\torder by name\\r\\n\\r\\nopen cur\\r\\n\\r\\nfetch next from cur into @t\\r\\nwhile @@FETCH_STATUS = 0\\r\\n  begin\\r\\n\\tset @sql =\\r\\n\\t\\t'select ''' + @t + ''' as name, count(1)\\r\\n\\t\\tfrom Staging.' + @t + ' with (nolock)'\\r\\n\\t\\r\\n\\tinsert into @table\\r\\n\\texec(@sql)\\r\\n\\t\\r\\n\\tfetch next from cur into @t\\r\\n  end\\r\\n\\r\\nclose cur\\r\\ndeallocate cur\\r\\n\\r\\nselect [name], [count]\\r\\nfrom @table\",\"InstanceType\":1},\"ComparisonType\":2,\"Right\":{\"ValueTypeID\":\"07f87b7f-c063-47a2-a5be-772ba85ed827\",\"Value\":\"500000\"},\"ID\":\"1\"}],\"BooleanOperationType\":0,\"ID\":\"0\"}","EvaluationFrequency":"00:03:00","IdlePeriod":"00:00:30","MaximumAllowedDuration":"00:00:05","AntiConditionID":"5a6df41a-7c43-4515-bdaa-f60dabb2a232","MinWindowsVersion":null,"MaxWindowsVersion":null,"MinSQLServerVersion":null,"MaxSQLServerVersion":null,"MinSSASVersion":null,"MaxSSASVersion":null,"MinVmwareVersion":null,"MaxVmwareVersion":null,"MinSqlDbVersion":null,"MaxSqlDbVersion":null,"MaximumInstanceCount":20,"ColorIndicator":null,"Severity":1,"Signature":{"ConditionID":"b63f8879-c033-472e-9373-dd6c39bba04f","VersionNumber":4,"AppliesToObjectTypeID":"894de672-3fc0-4779-9a0d-880d4c207c77","RuleDefinition":"{\"OperationTypeID\":\"6c3d38f1-9317-4258-972a-cfee0a0d76b5\",\"Children\":[{\"OperationTypeID\":\"8fa3cd6a-960c-43bb-96e0-94092fc2c296\",\"ValueDataTypeID\":\"b35a57f5-b8f6-4e4e-9380-e9d328e3eabf\",\"Left\":{\"ValueTypeID\":\"f2e88d72-73c6-4ce1-b92a-029c313e707f\",\"Query\":\"set nocount on\\r\\n\\r\\ndeclare @t nvarchar(128)\\r\\ndeclare @sql nvarchar(1000)\\r\\ndeclare @table table\\r\\n\\t([name] nvarchar(128)\\r\\n\\t,[count] bigint)\\r\\n\\r\\ndeclare cur cursor fast_forward\\r\\nfor\\r\\n\\tselect name from sys.objects\\r\\n\\twhere schema_id = SCHEMA_ID('Staging')\\r\\n\\torder by name\\r\\n\\r\\nopen cur\\r\\n\\r\\nfetch next from cur into @t\\r\\nwhile @@FETCH_STATUS = 0\\r\\n  begin\\r\\n\\tset @sql =\\r\\n\\t\\t'select ''' + @t + ''' as name, count(1)\\r\\n\\t\\tfrom Staging.' + @t + ' with (nolock)'\\r\\n\\t\\r\\n\\tinsert into @table\\r\\n\\texec(@sql)\\r\\n\\t\\r\\n\\tfetch next from cur into @t\\r\\n  end\\r\\n\\r\\nclose cur\\r\\ndeallocate cur\\r\\n\\r\\nselect [name], [count]\\r\\nfrom @table\",\"InstanceType\":1},\"ComparisonType\":2,\"Right\":{\"ValueTypeID\":\"07f87b7f-c063-47a2-a5be-772ba85ed827\",\"Value\":\"500000\"},\"ID\":\"1\"}],\"BooleanOperationType\":0,\"ID\":\"0\"}","PublisherID":0,"PublishDateUtc":"2018-11-30T13:22:22","Rights":0,"SignatureVersion":1,"SignaturePublicKey":"<RSAKeyValue><Modulus>uzJQ9gzevXFwOgw/hkcAtD+cA/bBbD1PRzhEZCxbZ6YwjJ1c9bbfXFItLQNwnm8bdWh2k57//qbpEj5DFHOW2EAjHc2Zw5m/vACm6OzelubPS5hbWvzshlaBJKm7KrpWQpPZClx/5eVvUVzOtlz+44RRTiOszObT58acJAQwA70=</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>","Signature":"RPLDIaxjkDeGfsuMTKouhlLH4LrY9An7p7Xl5RmrFnYu8o0DSXkSdNZHd05a0/koSFeEC3LobXYSKPD6n7O4GCRVD7v6HZ4kyMB/El8A9/d5viMfr8JjHAgeDEEpi2pW1qAgS4i6Mbdqkai9dxU2ZLfn9BtuXLJJ7tvuTZ5OaUo=","IsSelfPublishedCondition":true},"Tags":null,"Areas":[],"ConditionSystemVersion":3,"MinDBSchemaVersion":null,"MaxDBSchemaVersion":null,"Items":[]}